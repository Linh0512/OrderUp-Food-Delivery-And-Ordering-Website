# OrderUp Docker Management Makefile

.PHONY: help build up down restart logs clean status health

# Default target
help:
	@echo "ğŸ³ OrderUp Docker Commands:"
	@echo ""
	@echo "ğŸ“‹ CÃ¡c lá»‡nh cÃ³ sáºµn:"
	@echo "  make build     - Build táº¥t cáº£ containers"
	@echo "  make up        - Khá»Ÿi Ä‘á»™ng á»©ng dá»¥ng"
	@echo "  make down      - Dá»«ng á»©ng dá»¥ng"
	@echo "  make restart   - Restart á»©ng dá»¥ng"
	@echo "  make logs      - Xem logs"
	@echo "  make status    - Kiá»ƒm tra tráº¡ng thÃ¡i containers"
	@echo "  make health    - Kiá»ƒm tra health cá»§a services"
	@echo "  make clean     - Dá»n dáº¹p containers vÃ  images"
	@echo ""
	@echo "ğŸŒ Sau khi cháº¡y 'make up':"
	@echo "  Frontend: http://localhost"
	@echo "  Backend:  http://localhost:8080"

# Build containers
build:
	@echo "ğŸ”¨ Building containers..."
	docker-compose build

# Start application
up:
	@echo "ğŸš€ Starting OrderUp application..."
	docker-compose up -d
	@echo "âœ… Application started!"
	@echo "ğŸŒ Frontend: http://localhost"
	@echo "ğŸ”§ Backend:  http://localhost:8080"

# Stop application
down:
	@echo "â¹ï¸ Stopping application..."
	docker-compose down

# Restart application
restart:
	@echo "ğŸ”„ Restarting application..."
	docker-compose restart

# View logs
logs:
	@echo "ğŸ“‹ Viewing logs..."
	docker-compose logs -f

# Check container status
status:
	@echo "ğŸ“Š Container status:"
	docker-compose ps

# Health check
health:
	@echo "ğŸ¥ Checking health..."
	@echo "Backend health:"
	@curl -s http://localhost:8080/actuator/health | jq . || echo "Backend not responding"
	@echo ""
	@echo "Frontend health:"
	@curl -s -o /dev/null -w "Status: %{http_code}\n" http://localhost || echo "Frontend not responding"

# Clean up
clean:
	@echo "ğŸ§¹ Cleaning up..."
	docker-compose down -v
	docker system prune -f
	@echo "âœ… Cleanup completed!"

# Quick start with build
start: build up

# Development mode (with logs)
dev:
	@echo "ğŸ› ï¸ Starting in development mode..."
	docker-compose up --build 